<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VIDRO ART MUZ - Orçamentos</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
    }
    .glass-card {
      backdrop-filter: blur(8px);
      background: rgba(255, 255, 255, 0.7);
      border-radius: 1rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .transition-hover {
      transition: all 0.3s ease-in-out;
    }
    .transition-hover:hover {
      transform: scale(1.02);
    }
    .input-field {
      width: 100%;
      border: 1px solid #86efac;
      border-radius: 0.375rem;
      padding: 0.5rem;
      outline: none;
    }
    .btn-green {
      background-color: #16a34a;
      color: white;
      padding: 0.5rem 1.25rem;
      border-radius: 0.375rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    .btn-black {
      background-color: #000;
      color: white;
      padding: 0.5rem 1.25rem;
      border-radius: 0.375rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    .product-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      background-color: #f9fafb;
    }
    .product-item img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 0.25rem;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-green-100 via-white to-green-50 min-h-screen">
  <header class="bg-green-900 text-white py-6 shadow-md">
    <div class="max-w-7xl mx-auto px-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold tracking-wide">VIDRO ART MUZ</h1>
      <nav class="space-x-4 text-sm">
        <a href="#orcamento" class="hover:underline">Orçamento</a>
        <a href="#servicos" class="hover:underline">Serviços</a>
      </nav>
    </div>
  </header>

  <section class="text-center py-16 px-4 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1581387570087-51c1c87f3c0c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');">
    <div class="max-w-3xl mx-auto bg-white bg-opacity-80 p-8 rounded-2xl shadow-xl">
      <h2 class="text-4xl font-bold text-green-900 mb-4">Soluções em Vidraçaria com Excelência</h2>
      <p class="text-lg text-green-800">Portas, janelas, box e projetos sob medida para sua casa ou empresa.</p>
    </div>
  </section>

  <section id="orcamento" class="py-16">
    <div class="max-w-6xl mx-auto px-4">
      <h3 class="text-3xl font-bold text-green-800 text-center mb-10">Gerar Orçamento</h3>
      <div class="glass-card p-8">
        <form class="space-y-6 animate-fade-in" onsubmit="return false;"> <!-- Adicionado onsubmit="return false;" para evitar recarregar a página -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <input type="text" id="clienteNome" placeholder="Nome do Cliente" class="input-field">
            <input type="text" id="clienteTelefone" placeholder="Telefone" class="input-field">
            <input type="email" id="clienteEmail" placeholder="E-mail" class="input-field">
            <input type="text" id="clienteEndereco" placeholder="Endereço da Obra" class="input-field">
          </div>
          <hr class="my-6 border-green-200">
          <div class="grid grid-cols-1 gap-4">
            <input type="text" id="produtoNome" placeholder="Produto (ex: Box Incolor 8mm)" class="input-field">
            <div class="grid grid-cols-2 gap-4">
              <input type="number" id="produtoLargura" placeholder="Largura (mm)" class="input-field">
              <input type="number" id="produtoAltura" placeholder="Altura (mm)" class="input-field">
            </div>
            <input type="number" id="produtoQtd" placeholder="Quantidade" value="1" class="input-field">
            <input type="text" id="produtoVidro" placeholder="Vidro (ex: temperado, fumê, etc.)" class="input-field">
            <input type="number" step="0.01" id="produtoArea" placeholder="Área Total (m²)" class="input-field">
            <input type="number" step="0.01" id="produtoUnitario" placeholder="Valor Unitário (R$)" class="input-field">
            <input type="number" step="0.01" id="produtoTotal" placeholder="Valor Total (R$)" class="input-field">
            <input type="file" accept="image/*" id="produtoFoto" class="input-field">
          </div>
          <div class="flex justify-center gap-4">
            <button type="button" class="btn-green" onclick="adicionarProduto()"><i class="fas fa-plus"></i> Adicionar Produto</button>
            <button type="button" class="btn-black" onclick="gerarPDF()"><i class="fas fa-file-pdf"></i> Gerar Orçamento</button>
          </div>
        </form>

        <div id="produtosAdicionadosContainer" class="mt-8 space-y-4">
          <h4 class="text-xl font-bold text-green-800">Produtos Adicionados:</h4>
          <div id="listaProdutos" class="space-y-3">
            <!-- Produtos adicionados serão listados aqui -->
            <p class="text-gray-500" id="noProductsMessage">Nenhum produto adicionado ainda.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="servicos" class="py-16 bg-green-50">
    <div class="max-w-6xl mx-auto px-4">
      <h3 class="text-3xl font-bold text-green-800 text-center mb-10">Nossos Serviços</h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="glass-card p-6 transition-hover">
          <i class="fas fa-door-open text-green-800 text-3xl mb-4"></i>
          <h4 class="font-bold text-lg text-green-900 mb-2">Portas de Vidro</h4>
          <p class="text-green-800 text-sm">Portas pivotantes, de correr e sob medida com acabamento de alto padrão.</p>
        </div>
        <div class="glass-card p-6 transition-hover">
          <i class="fas fa-shower text-green-800 text-3xl mb-4"></i>
          <h4 class="font-bold text-lg text-green-900 mb-2">Box para Banheiro</h4>
          <p class="text-green-800 text-sm">Modelos modernos, seguros e fáceis de limpar com instalação inclusa.</p>
        </div>
        <div class="glass-card p-6 transition-hover">
          <i class="fas fa-building text-green-800 text-3xl mb-4"></i>
          <h4 class="font-bold text-lg text-green-900 mb-2">Fechamentos e Fachadas</h4>
          <p class="text-green-800 text-sm">Projetos personalizados para fachadas comerciais e varandas residenciais.</p>
        </div>
      </div>
    </div>
  </section>

  <footer class="bg-green-900 text-white text-center py-6 mt-16">
    <p>&copy; 2025 VIDRO ART MUZ. Todos os direitos reservados.</p>
  </footer>

  <script>
    // Array para armazenar os produtos adicionados
    let produtosAdicionados = [];

    // Função para adicionar um produto à lista
    async function adicionarProduto() {
      const nomeProduto = document.getElementById("produtoNome").value;
      const largura = document.getElementById("produtoLargura").value;
      const altura = document.getElementById("produtoAltura").value;
      const qtd = document.getElementById("produtoQtd").value;
      const vidro = document.getElementById("produtoVidro").value;
      const area = document.getElementById("produtoArea").value;
      const unitario = document.getElementById("produtoUnitario").value;
      const total = document.getElementById("produtoTotal").value;
      const fotoFile = document.getElementById("produtoFoto").files[0];
      let fotoDataURL = '';

      // Validação básica dos campos
      if (!nomeProduto || !largura || !altura || !qtd || !vidro || !area || !unitario || !total) {
        alert("Por favor, preencha todos os campos do produto antes de adicionar.");
        return;
      }

      // Converte a imagem para DataURL se houver uma
      if (fotoFile) {
        fotoDataURL = await new Promise((resolve) => {
          const reader = new FileReader();
          reader.onload = (e) => resolve(e.target.result);
          reader.readAsDataURL(fotoFile);
        });
      }

      // Cria o objeto do novo produto
      const novoProduto = {
        nome: nomeProduto,
        largura: largura,
        altura: altura,
        quantidade: qtd,
        vidro: vidro,
        area: area,
        valorUnitario: unitario,
        valorTotal: total,
        foto: fotoDataURL
      };

      // Adiciona o produto ao array
      produtosAdicionados.push(novoProduto);
      // Atualiza a exibição na página
      renderizarProdutosAdicionados();
      // Limpa os campos do formulário de produto
      limparCamposProduto();
    }

    // Função para renderizar os produtos adicionados na página
    function renderizarProdutosAdicionados() {
      const listaProdutosDiv = document.getElementById("listaProdutos");
      listaProdutosDiv.innerHTML = ''; // Limpa a lista existente

      if (produtosAdicionados.length === 0) {
        listaProdutosDiv.innerHTML = '<p class="text-gray-500" id="noProductsMessage">Nenhum produto adicionado ainda.</p>';
        return;
      }

      // Remove a mensagem "Nenhum produto adicionado" se houver produtos
      document.getElementById("noProductsMessage")?.remove(); 

      // Adiciona cada produto à lista na página
      produtosAdicionados.forEach((produto, index) => {
        const productItemDiv = document.createElement('div');
        productItemDiv.className = 'product-item';
        productItemDiv.innerHTML = `
          ${produto.foto ? `<img src="${produto.foto}" alt="${produto.nome}">` : ''}
          <div>
            <p class="font-semibold">${produto.nome} (${produto.largura}x${produto.altura}mm)</p>
            <p>Qtd: ${produto.quantidade} | Vidro: ${produto.vidro} | Área: ${produto.area}m²</p>
            <p>Valor Unitário: R$ ${produto.valorUnitario} | Valor Total: R$ ${produto.valorTotal}</p>
          </div>
          <button type="button" class="text-red-500 hover:text-red-700 ml-auto" onclick="removerProduto(${index})">
            <i class="fas fa-trash-alt"></i>
          </button>
        `;
        listaProdutosDiv.appendChild(productItemDiv);
      });
    }

    // Função para remover um produto da lista
    function removerProduto(index) {
      produtosAdicionados.splice(index, 1); // Remove o produto do array
      renderizarProdutosAdicionados(); // Renderiza a lista novamente
    }

    // Função para limpar os campos do formulário de produto
    function limparCamposProduto() {
      document.getElementById("produtoNome").value = '';
      document.getElementById("produtoLargura").value = '';
      document.getElementById("produtoAltura").value = '';
      document.getElementById("produtoQtd").value = '1';
      document.getElementById("produtoVidro").value = '';
      document.getElementById("produtoArea").value = '';
      document.getElementById("produtoUnitario").value = '';
      document.getElementById("produtoTotal").value = '';
      document.getElementById("produtoFoto").value = ''; // Limpa o input de arquivo
    }

    // Função principal para gerar o PDF
    async function gerarPDF() {
      if (produtosAdicionados.length === 0) {
        alert("Por favor, adicione pelo menos um produto ao orçamento antes de gerar o PDF.");
        return;
      }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF("p", "mm", "a4");
      let y = 20;
      const lineSpacing = 6; // Espaçamento padrão entre as linhas de texto

      // Logo e cabeçalho da empresa
      doc.setFontSize(12);
      doc.setFont(undefined, "bold");
      doc.text("VIDRO ART MUZ", 20, y);
      doc.setFontSize(10);
      doc.setFont(undefined, "normal");
      doc.text("Endereço: Avenida Frei Florentino, 214, Centro, Muzambinho", 20, y += lineSpacing);
      doc.text("CNPJ: 00.000.000/0001-00", 20, y += lineSpacing);
      doc.text("Telefone: (35)3571-5750", 20, y += lineSpacing);
      doc.text("Email: vidroartmuz@gmail.com", 20, y += lineSpacing);
      y += 10;

      // Dados do cliente
      doc.setFontSize(11);
      doc.setFont(undefined, "bold");
      doc.text("DADOS DO CLIENTE", 20, y);
      doc.setFont(undefined, "normal");
      y += lineSpacing;
      doc.text(`Nome: ${document.getElementById("clienteNome").value}`, 20, y);
      doc.text(`Telefone: ${document.getElementById("clienteTelefone").value}`, 20, y += lineSpacing);
      doc.text(`E-mail: ${document.getElementById("clienteEmail").value}`, 20, y += lineSpacing);
      doc.text(`Endereço da Obra: ${document.getElementById("clienteEndereco").value}`, 20, y += lineSpacing);
      y += 10;

      // Título produtos
      doc.setFillColor(16, 163, 74);
      doc.setTextColor(255);
      doc.rect(20, y, 170, 8, "F");
      doc.text("PRODUTOS", 105, y + 5, { align: "center" });
      y += 14;
      doc.setTextColor(0);

      let totalGeralOrcamento = 0;

      // Loop para adicionar cada produto
      for (let i = 0; i < produtosAdicionados.length; i++) {
        const produto = produtosAdicionados[i];

        // Verifica se há espaço suficiente para o próximo produto
        // Estimativa de altura para um produto (imagem + texto + espaçamento)
        const estimatedProductHeight = 50; // Ajuste conforme necessário
        if (y + estimatedProductHeight > doc.internal.pageSize.height - 30) { // -30 para margem inferior
            doc.addPage();
            y = 20; // Reinicia Y na nova página
            // Redesenha o título de produtos na nova página se necessário
            doc.setFillColor(16, 163, 74);
            doc.setTextColor(255);
            doc.rect(20, y, 170, 8, "F");
            doc.text("PRODUTOS (continuação)", 105, y + 5, { align: "center" });
            y += 14;
            doc.setTextColor(0);
        }

        doc.setFont(undefined, "bold");
        doc.text(`ITEM ${i + 1}`, 20, y);
        doc.setFont(undefined, "normal");

        const initialProductY = y + lineSpacing;
        let currentProductY = initialProductY;
        let imageHeight = 0;
        const imageWidth = 30;

        if (produto.foto) {
          const img = new Image();
          img.src = produto.foto;
          // Espera a imagem carregar antes de adicioná-la ao PDF
          await new Promise(resolve => img.onload = resolve); 

          imageHeight = (img.height / img.width) * imageWidth;
          doc.addImage(img, "JPEG", 20, currentProductY, imageWidth, imageHeight);

          const textX = 55;
          let textY = currentProductY;

          doc.text(`Produto: ${produto.nome}`, textX, textY);
          textY += lineSpacing;
          doc.text(`Largura x Altura: ${produto.largura} x ${produto.altura} mm`, textX, textY);
          textY += lineSpacing;
          doc.text(`Vidro: ${produto.vidro}`, textX, textY);
          textY += lineSpacing;
          doc.text(`Área: ${produto.area} m²`, textX, textY);
          textY += lineSpacing;
          doc.text(`Quantidade: ${produto.quantidade}`, textX, textY);
          textY += lineSpacing;
          doc.text(`Valor Unitário: R$ ${produto.valorUnitario}`, textX, textY);
          textY += lineSpacing + 2;
          doc.setFont(undefined, "bold");
          doc.text(`VALOR TOTAL: R$ ${produto.valorTotal}`, textX, textY);
          doc.setFont(undefined, "normal");

          y = Math.max(currentProductY + imageHeight, textY) + 10;
        } else {
          doc.text(`Produto: ${produto.nome}`, 20, currentProductY);
          currentProductY += lineSpacing;
          doc.text(`Largura x Altura: ${produto.largura} x ${produto.altura} mm`, 20, currentProductY);
          currentProductY += lineSpacing;
          doc.text(`Vidro: ${produto.vidro}`, 20, currentProductY);
          currentProductY += lineSpacing;
          doc.text(`Área: ${produto.area} m²`, 20, currentProductY);
          currentProductY += lineSpacing;
          doc.text(`Quantidade: ${produto.quantidade}`, 20, currentProductY);
          currentProductY += lineSpacing;
          doc.text(`Valor Unitário: R$ ${produto.valorUnitario}`, 20, currentProductY);
          currentProductY += lineSpacing + 2;
          doc.setFont(undefined, "bold");
          doc.text(`VALOR TOTAL: R$ ${produto.valorTotal}`, 20, currentProductY);
          doc.setFont(undefined, "normal");

          y = currentProductY + 10;
        }
        totalGeralOrcamento += parseFloat(produto.valorTotal);
      }

      // Adicionar rodapé
      // Verifica se há espaço suficiente para o rodapé, se não, adiciona uma nova página
      if (y + 50 > doc.internal.pageSize.height) {
          doc.addPage();
          y = 20; // Reinicia a posição Y na nova página
      }

      doc.setFont(undefined, "normal");
      const hoje = new Date();
      const entrega = new Date();
      entrega.setDate(hoje.getDate() + 10);

      doc.setFontSize(10);
      doc.text("PREVISÃO DE ENTREGA:", 20, y);
      doc.text(entrega.toLocaleDateString(), 70, y);
      doc.text("ORÇAMENTO VÁLIDO ATÉ:", 110, y);
      doc.text(new Date(hoje.getTime() + 5 * 24 * 60 * 60 * 1000).toLocaleDateString(), 180, y, { align: "right" });

      y += 10;
      doc.setFontSize(11);
      doc.setFont(undefined, "bold");
      doc.text(`VALOR FINAL: R$ ${totalGeralOrcamento.toFixed(2)}`, 20, y);

      y += 20;
      doc.line(20, y, 190, y);
      doc.setFontSize(10);
      doc.setFont(undefined, "normal");
      doc.text("CLIENTE", 20, y + 5);
      doc.text("MODELO", 160, y + 5);

      window.open(doc.output("bloburl"), "_blank");
    }
  </script>
</body>
</html>
```
